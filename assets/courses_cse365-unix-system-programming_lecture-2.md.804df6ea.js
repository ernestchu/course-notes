import{_ as s,c as e,o as a,b as n}from"./app.b33521bb.js";const o="/course-notes/assets/tee.03251343.svg",D=JSON.parse('{"title":"Lecture 2","description":"","frontmatter":{},"headers":[{"level":2,"title":"Miscellaneous Commands","slug":"miscellaneous-commands","link":"#miscellaneous-commands","children":[{"level":3,"title":"cut","slug":"cut","link":"#cut","children":[]}]},{"level":2,"title":"Redirection","slug":"redirection","link":"#redirection","children":[{"level":3,"title":"Redirection can affect commands","slug":"redirection-can-affect-commands","link":"#redirection-can-affect-commands","children":[]},{"level":3,"title":"Various redrection modes","slug":"various-redrection-modes","link":"#various-redrection-modes","children":[]},{"level":3,"title":"The pipe","slug":"the-pipe","link":"#the-pipe","children":[]}]},{"level":2,"title":"Command Coordination","slug":"command-coordination","link":"#command-coordination","children":[{"level":3,"title":"Semicolon","slug":"semicolon","link":"#semicolon","children":[]},{"level":3,"title":"Double ampersands and bars","slug":"double-ampersands-and-bars","link":"#double-ampersands-and-bars","children":[]}]}],"relativePath":"courses/cse365-unix-system-programming/lecture-2.md"}'),t={name:"courses/cse365-unix-system-programming/lecture-2.md"},l=n(`<h1 id="lecture-2" tabindex="-1">Lecture 2 <a class="header-anchor" href="#lecture-2" aria-hidden="true">#</a></h1><h2 id="miscellaneous-commands" tabindex="-1">Miscellaneous Commands <a class="header-anchor" href="#miscellaneous-commands" aria-hidden="true">#</a></h2><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>echo [string]</code></td><td>print the string, use <code>-n</code> to prevent newline</td></tr><tr><td><code>wc [filename]</code></td><td>word count. [#lines][#words][#characters][filename]</td></tr><tr><td><code>cut [filename]</code></td><td><code>cut</code> charaters(<code>-c</code>) or fields(<code>-f</code>) from each input line</td></tr><tr><td><code>alias </code></td><td>create a command shortcut</td></tr><tr><td><code>basename [string]</code></td><td>print the end part of the argument sent to it</td></tr><tr><td><code>history</code></td><td>list the history of commands you typed</td></tr><tr><td>\`![number</td><td>prefix]\`</td></tr></tbody></table><h3 id="cut" tabindex="-1">cut <a class="header-anchor" href="#cut" aria-hidden="true">#</a></h3><p><code>-c</code> and <code>-f</code> can be followed by indices or ranges, where the index start from 1 instead of 0.</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">% cat file</span></span>
<span class="line"><span style="color:#A6ACCD;">abcdefghijklmno</span></span>
<span class="line"><span style="color:#A6ACCD;">% cut -c4-5,10 file</span></span>
<span class="line"><span style="color:#A6ACCD;">dej</span></span>
<span class="line"></span></code></pre></div><p>Other useful flags are <code>--complement</code> and <code>-d</code></p><p><code>--complement</code> shows everything except charaters or fields specified by <code>-c</code> and <code>-f</code> repectively.</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">% cut --complement -c4-5,10 file</span></span>
<span class="line"><span style="color:#A6ACCD;">abcfghiklmno</span></span>
<span class="line"></span></code></pre></div><p><code>-d</code> specifies the <strong>delimiter</strong> to seperate fields, the delimiter is default to tab <code>\\t</code> if not specified.</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">% cat file</span></span>
<span class="line"><span style="color:#A6ACCD;">apple banana cherry</span></span>
<span class="line"><span style="color:#A6ACCD;">% cut -f1 file</span></span>
<span class="line"><span style="color:#A6ACCD;">apple banana cherry</span></span>
<span class="line"><span style="color:#A6ACCD;">% cut -f1 -d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> file</span></span>
<span class="line"><span style="color:#A6ACCD;">apple</span></span>
<span class="line"></span></code></pre></div><h2 id="redirection" tabindex="-1">Redirection <a class="header-anchor" href="#redirection" aria-hidden="true">#</a></h2><blockquote><p><code>cmd</code> is abbr. for <strong>command</strong> and <code>fn</code> is abbr. for <strong>filename</strong></p></blockquote><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>[cmd] &lt; [fn]</code></td><td>Redirect keyboard input to come from a file</td></tr><tr><td><code>[cmd] &gt;, 2&gt;, &amp;&gt; [fn]</code></td><td>Redirect screen output to a file</td></tr><tr><td><code>[cmd] &gt;&gt;, 2&gt;&gt; [fn]</code></td><td>Redirect screen output to the end of a file</td></tr><tr><td>\`[cmd]</td><td>[cmd]\`</td></tr><tr><td>\`[cmd]</td><td>tee [fn]</td></tr><tr><td><code>\`[cmd]\`</code></td><td>Redirect the output to become an inplace argument</td></tr><tr><td>\`[cmd]</td><td>xargs [cmd]\`</td></tr></tbody></table><h3 id="redirection-can-affect-commands" tabindex="-1">Redirection can affect commands <a class="header-anchor" href="#redirection-can-affect-commands" aria-hidden="true">#</a></h3><p>As we&#39;ve learned above, <code>wc -c File</code> will output the number of characters followed by the filename. However, if we didn&#39;t specify the filename, <code>wc</code> would take standard input as a file. In this case, no filename will be output, because there&#39;s no file. Also, we can use redirection to redirect standard input to come from a file. Same as above, <code>wc</code> have no idea of the existance of the file.</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">% wc -c File</span></span>
<span class="line"><span style="color:#A6ACCD;">100 File</span></span>
<span class="line"><span style="color:#A6ACCD;">% wc -c</span></span>
<span class="line"><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> This is typed</span></span>
<span class="line"><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> by ourselves</span></span>
<span class="line"><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> as input fed into wc</span></span>
<span class="line"><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> ^D</span></span>
<span class="line"><span style="color:#A6ACCD;">48</span></span>
<span class="line"><span style="color:#A6ACCD;">% wc -c </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> File</span></span>
<span class="line"><span style="color:#A6ACCD;">100</span></span>
<span class="line"></span></code></pre></div><p>A special case for <code>paste</code> command is that if we use <code>-</code> as the argument instead of a filename, <code>paste</code> would take input as the file (can be standard input or redirection).</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">% paste File1 File2</span></span>
<span class="line"><span style="color:#A6ACCD;">a	1</span></span>
<span class="line"><span style="color:#A6ACCD;">b	2</span></span>
<span class="line"><span style="color:#A6ACCD;">c	3</span></span>
<span class="line"><span style="color:#A6ACCD;">d	4</span></span>
<span class="line"><span style="color:#A6ACCD;">% paste File1 - &lt; File 2</span></span>
<span class="line"><span style="color:#A6ACCD;">a	1</span></span>
<span class="line"><span style="color:#A6ACCD;">b	2</span></span>
<span class="line"><span style="color:#A6ACCD;">c	3</span></span>
<span class="line"><span style="color:#A6ACCD;">d	4</span></span>
<span class="line"><span style="color:#A6ACCD;">% paste - - &lt; File 1</span></span>
<span class="line"><span style="color:#A6ACCD;">a   b</span></span>
<span class="line"><span style="color:#A6ACCD;">c   d</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h3 id="various-redrection-modes" tabindex="-1">Various redrection modes <a class="header-anchor" href="#various-redrection-modes" aria-hidden="true">#</a></h3><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">% cat File</span></span>
<span class="line"><span style="color:#A6ACCD;">Hello World</span><span style="color:#89DDFF;">!</span></span>
<span class="line"><span style="color:#A6ACCD;">% </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> End of the world :</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> File</span></span>
<span class="line"><span style="color:#A6ACCD;">% cat File</span></span>
<span class="line"><span style="color:#A6ACCD;">End of the world :</span><span style="color:#89DDFF;">(</span></span>
<span class="line"></span></code></pre></div><p>we can see that <code>echo</code> with the redirection <code>&gt;</code> overwrites the existing content in the file. How to prevent that? Use <code>&gt;&gt;</code> instead!</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">% cat File</span></span>
<span class="line"><span style="color:#A6ACCD;">Hello World</span><span style="color:#89DDFF;">!</span></span>
<span class="line"><span style="color:#A6ACCD;">% </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> End of the world :) </span><span style="color:#89DDFF;">&gt;&gt;</span><span style="color:#A6ACCD;"> File</span></span>
<span class="line"><span style="color:#A6ACCD;">% cat File</span></span>
<span class="line"><span style="color:#A6ACCD;">Hello World</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;"> End of the world :)</span></span>
<span class="line"></span></code></pre></div><p><code>&gt;&gt;</code> append the output of a command to the end of a file. In fact, there&#39;re serveral different redirection modes.</p><table><thead><tr><th>Redirection symbol</th><th>Description</th></tr></thead><tbody><tr><td>&amp;&gt;</td><td>Redirect stdout&amp;stderr</td></tr><tr><td>2&gt;</td><td>Redirect stderr only</td></tr><tr><td>&gt;&gt;</td><td>Redirect stdout to the end of a file only</td></tr><tr><td>2&gt;&gt;</td><td>Redirect stderr to the end of a file only</td></tr></tbody></table><p>In addition, if you just want to hide the output by redirection and you don&#39;t a dummy file to be generated, in Unix-like system, you can simply redirect the output to <code>/dev/null</code>, which is an abyss and you do not bother what&#39;s inside it.</p><h3 id="the-pipe" tabindex="-1">The pipe <a class="header-anchor" href="#the-pipe" aria-hidden="true">#</a></h3><p>You can link commands together into a single command sequence using pipes <code>|</code>. For example, to count how many files are in a directory</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">ls </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> wc -l</span></span>
<span class="line"></span></code></pre></div><h4 id="tee" tabindex="-1">Tee <a class="header-anchor" href="#tee" aria-hidden="true">#</a></h4><p>You can use <code>tee</code> to redirect the output to a file and the next command at once</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">ls -l </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> tee file.txt </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> less</span></span>
<span class="line"></span></code></pre></div><p><img src="`+o+`" alt="tee"></p><blockquote><p>Image credit to Wikipeida</p></blockquote><h4 id="backtick" tabindex="-1">Backtick <a class="header-anchor" href="#backtick" aria-hidden="true">#</a></h4><p>The command within the <code>\`[command]\`</code> would first be evaluated before run the entire command. For example</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">% ls -l</span></span>
<span class="line"><span style="color:#A6ACCD;">total 0</span></span>
<span class="line"><span style="color:#A6ACCD;">lrwxr-xr-x  1 ernestchu  staff  16 Apr 10 16:10 home -</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> /Users/ernestchu</span></span>
<span class="line"><span style="color:#A6ACCD;">% </span><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> home</span></span>
<span class="line"><span style="color:#A6ACCD;">% </span><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">pwd -P</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#A6ACCD;">% </span><span style="color:#82AAFF;">pwd</span></span>
<span class="line"><span style="color:#A6ACCD;">/Users/ernestchu</span></span>
<span class="line"></span></code></pre></div><p><code>pwd -P</code> first show the genuine path to current directory, in constrast to the symbolic one, then <code>cd</code> change the current directory to the <strong>argument</strong> generated by <code>pwd -P</code>.</p><h4 id="xargs" tabindex="-1">xargs <a class="header-anchor" href="#xargs" aria-hidden="true">#</a></h4><p>Consider a scenario that you want to find a keyword in all of the files under current directory. The candidate commands are</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">find </span><span style="color:#82AAFF;">.</span><span style="color:#A6ACCD;"> -type f -name </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">fgrep </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">keyword</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">filename</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><p>We know that <code>find</code> gives us a list of file names, but how can we feed those file names to <code>fgrep</code>? Maybe</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">find </span><span style="color:#82AAFF;">.</span><span style="color:#A6ACCD;"> -type f -name </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> fgrep </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">int main(</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p>However, this would be evaluated as</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">fgrep </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">int main(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">file1 file2 file3 ...</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p><code>fgrep</code> searches for the patterns in the string <code>&quot;file1 file2 file3 ...&quot;</code> and of course, <code>&quot;int main(&quot;</code> is not in that string. How would we use that string as individual arguments of file names? Use <code>xargs</code> instead.</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">find </span><span style="color:#82AAFF;">.</span><span style="color:#A6ACCD;"> -type f -name </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> xargs fgrep </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">int main(</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p>The command above would be evaluated as</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">fgrep </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">int main(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> file1 file2 file3 ...</span></span>
<span class="line"></span></code></pre></div><p>Of course, if I were not writting note on <code>xargs</code>, I would just use backticks</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">fgrep </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">int main(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">find </span><span style="color:#82AAFF;">.</span><span style="color:#C3E88D;"> -type f -name </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&quot;\`</span><span style="color:#A6ACCD;">   </span></span>
<span class="line"></span></code></pre></div><p>But there&#39;s also cases where <code>xargs</code> is irreplaceable.</p><h2 id="command-coordination" tabindex="-1">Command Coordination <a class="header-anchor" href="#command-coordination" aria-hidden="true">#</a></h2><p>There are three operator that connect commands</p><ul><li>Semicolon <code>;</code></li><li>Double ampersands <code>&amp;&amp;</code></li><li>Double bars <code>||</code></li></ul><h3 id="semicolon" tabindex="-1">Semicolon <a class="header-anchor" href="#semicolon" aria-hidden="true">#</a></h3><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> ls</span></span>
<span class="line"></span></code></pre></div><p>The semicolon linking two commands just enables them to be typed on the same line. The command above is equivalent to</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">ls</span></span>
<span class="line"></span></code></pre></div><h3 id="double-ampersands-and-bars" tabindex="-1">Double ampersands and bars <a class="header-anchor" href="#double-ampersands-and-bars" aria-hidden="true">#</a></h3><p>You may have seen <code>&amp;&amp;</code> in C programming language expression. In Unix shell, it can also be used to produce an boolean expression. But more frequenly, it is used with <strong>short circuit evaluation</strong>. Consider</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">cat ExistingFile </span><span style="color:#89DDFF;">&amp;&gt;</span><span style="color:#A6ACCD;"> /dev/null </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> executed</span></span>
<span class="line"></span></code></pre></div><p>If the <code>ExistingFile</code> do exist, then to get the boolean value of the expression we still need to consider the latter command. So the output will be <code>echo executed</code>. However, if the filename lied, the file cannot be found, then right after the former command is evaluated as false due to the error, the result of the entire expression is determined to be <strong>false</strong>. Therefore, the latter command needn&#39;t and won&#39;t be executed. There would be no output.</p><p>On the other hand, consider</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">cat ExistingFile </span><span style="color:#89DDFF;">&amp;&gt;</span><span style="color:#A6ACCD;"> /dev/null </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> executed</span></span>
<span class="line"></span></code></pre></div><p>If the first command succeeded, then the result of the expression is determined and there would be no output, vice versa.</p><p>Though we&#39;ll meet if else later in the shell script, but we can purely use <code>&amp;&amp;</code> and <code>||</code> to mimic the conditional statement. Since we&#39;ve not learned the if else syntax in shell script, let&#39;s use C-fashion syntax!</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">cmd1</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">do</span><span style="color:#A6ACCD;"> cmd2</span></span>
<span class="line"><span style="color:#89DDFF;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">do</span><span style="color:#A6ACCD;"> cmd3</span></span>
<span class="line"></span></code></pre></div><p>This command snippet can be written in the following form</p><div class="language-sh"><button class="copy"></button><span class="lang">sh</span><pre><code><span class="line"><span style="color:#A6ACCD;">cmd1 </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> cmd2 </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> cmd3</span></span>
<span class="line"></span></code></pre></div><p>You can think a little bit to figure it our why it works. It&#39;s pretty simple! if you need a nested if else, just use parenthesis to wrap the expression up.</p>`,71),p=[l];function c(r,d,i,h,u,y){return a(),e("div",null,p)}const C=s(t,[["render",c]]);export{D as __pageData,C as default};
