import{c as s,o as t,F as a,a as n,d as e}from"./app.bdc3a143.js";import{_ as l}from"./plugin-vue_export-helper.5a098b48.js";var o="/course-notes/assets/screenshot.40988b7e.png";const r={},i=n("h1",{id:"homework-1",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#homework-1","aria-hidden":"true"},"#"),e(" Homework 1")],-1),c=n("h5",{id:"cse491-network-application-programming-sping-2021",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#cse491-network-application-programming-sping-2021","aria-hidden":"true"},"#"),e(" CSE491 Network Application Programming, Sping 2021")],-1),u=n("h5",{id:"instructor-you-chiun-wang",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#instructor-you-chiun-wang","aria-hidden":"true"},"#"),e(" Instructor: You-Chiun Wang")],-1),d=n("h5",{id:"author-b073040018-\u6731\u52AD\u74BF",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#author-b073040018-\u6731\u52AD\u74BF","aria-hidden":"true"},"#"),e(" Author: B073040018 \u6731\u52AD\u74BF")],-1),h=n("h5",{id:"national-sun-yat-sen-university",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#national-sun-yat-sen-university","aria-hidden":"true"},"#"),e(" National Sun Yat-sen University")],-1),p=n("h2",{id:"introduction",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#introduction","aria-hidden":"true"},"#"),e(" Introduction")],-1),b=n("table",null,[n("thead",null,[n("tr",null,[n("th",null,"Environments"),n("th")])]),n("tbody",null,[n("tr",null,[n("td",null,"Device"),n("td",null,"MackBook Pro (15-inch, 2017)")]),n("tr",null,[n("td",null,"Operating system"),n("td",null,"macOS Big Sur 11.2.3")]),n("tr",null,[n("td",null,"Location"),n("td",null,"Info-Libaray Building 3F, NSYSU")]),n("tr",null,[n("td",null,"Wi-Fi SSID"),n("td",null,"TANetRoaming")])])],-1),m=n("p",null,"First, inspect the Internet interfaces on my computer",-1),g=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,`networksetup -listallhardwareports
`)]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br")])],-1),_=n("p",null,"I got ports for Wi-Fi, Bluetooth PAN, and many Thunderbolt ports since I don't have Ethernet port on my device but four Thunderbolt ports in the form of USB Type-C.",-1),f=n("div",{class:"language-text ext-text line-numbers-mode"},[n("pre",{class:"language-text"},[n("code",null,`Hardware Port: Wi-Fi
Device: en0
Ethernet Address: 8c:85:90:67:f8:e6

Hardware Port: Bluetooth PAN
Device: en6
Ethernet Address: 8c:85:90:63:29:04

Hardware Port: Thunderbolt 1
Device: en1
Ethernet Address: 82:da:01:04:08:01
`)]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br"),n("span",{class:"line-number"},"4"),n("br"),n("span",{class:"line-number"},"5"),n("br"),n("span",{class:"line-number"},"6"),n("br"),n("span",{class:"line-number"},"7"),n("br"),n("span",{class:"line-number"},"8"),n("br"),n("span",{class:"line-number"},"9"),n("br"),n("span",{class:"line-number"},"10"),n("br"),n("span",{class:"line-number"},"11"),n("br")])],-1),P=n("blockquote",null,[n("p",null,"Other Tunderbolt ports are truncated")],-1),w=n("p",null,[e("I'm using Wi-Fi so I'll focus on only en0. Also, I'll filter out the connections with Apple's server, with which my computer constantly exchange data with, by "),n("code",null,"not host 17.248"),e(". For example")],-1),y=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,[e("tcpdump -ien0 not "),n("span",{class:"token function"},"host"),e(),n("span",{class:"token number"},"17.248"),e(`
`)])]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br")])],-1),I=n("h2",{id:"https",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#https","aria-hidden":"true"},"#"),e(" HTTPS")],-1),v=n("p",null,[e("Let's first watch a YouTube Video on the browser and listen for packets through port 443. I assume YouTube would use TCP since it presents high quality videos. When a connection is established in TCP, we may observe "),n("strong",null,"SYN"),e(" and "),n("strong",null,"ACK"),e(". Let's look at the TCP header.")],-1),x=n("table",null,[n("tr",null,[n("th",{colspan:"16"},"0"),n("th",{colspan:"16"},"15")]),n("tr",null,[n("td",{colspan:"16"},"source port number"),n("td",{colspan:"16"},"destination port number")]),n("tr",null,[n("td",{colspan:"32"},"32-bit sequence number")]),n("tr",null,[n("td",{colspan:"32"},"32-bit acknowledgement number")]),n("tr",null,[n("td",{colspan:"4"},"header length"),n("td",{colspan:"6"},"6-bit reserved"),n("td",{colspan:"1"},"U"),n("td",{colspan:"1"},"A"),n("td",{colspan:"1"},"P"),n("td",{colspan:"1"},"R"),n("td",{colspan:"1"},"S"),n("td",{colspan:"1"},"F"),n("td",{colspan:"16"},"window size")]),n("tr",null,[n("td",{colspan:"16"},"TCP checksum"),n("td",{colspan:"16"},"urgent pointer")])],-1),k=n("p",null,[e("Assume we store the header in an array "),n("code",null,"tcp"),e(" with "),n("code",null,"sizeof(tcp)"),e(" equals 1 byte. Then the flags are located at "),n("code",null,"tcp[13]"),e(" (little endian). We can check if a packet is a")],-1),T=n("ul",null,[n("li",null,[n("strong",null,"ACK"),e(" by "),n("code",null,"tcp[13] & (1<<4) != 0")]),n("li",null,[n("strong",null,"SYN"),e(" by "),n("code",null,"tcp[13] & (1<<1) != 0"),e(".")])],-1),S=n("p",null,"Therefore, try this command and start playing YouTube",-1),D=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,[e("tcpdump -ien0 -c4 -q "),n("span",{class:"token string"},"'tcp[13] & 2 != 0'"),e(" and port "),n("span",{class:"token number"},"443"),e(" and not "),n("span",{class:"token function"},"host"),e(),n("span",{class:"token number"},"17.248"),e(`
`)])]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br")])],-1),N=n("p",null,[e("where "),n("code",null,"-c4"),e(" specifies showing only 10 next records, and "),n("code",null,"-q"),e(" gives us a shorter output. We than get")],-1),U=n("div",{class:"language-text ext-text line-numbers-mode"},[n("pre",{class:"language-text"},[n("code",null,`19:28:23.269026 IP 172.20.18.78.64089 > cache.google.com.https: tcp 0
19:28:23.269670 IP 172.20.18.78.64090 > cache.google.com.https: tcp 0
19:28:23.271292 IP cache.google.com.https > 172.20.18.78.64089: tcp 0
19:28:23.274418 IP cache.google.com.https > 172.20.18.78.64090: tcp 0
`)]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br"),n("span",{class:"line-number"},"4"),n("br")])],-1),A=n("p",null,"Cool! Four SYN packets were captured within 0.01 second. Both of my computer and the server from Google were sending packets, that probabily means a handshaking. Let's invite ACK to join the party!",-1),C=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,[e("tcpdump -ien0 -q -c10 "),n("span",{class:"token string"},"'tcp[13] & 18 != 0'"),e(" and port "),n("span",{class:"token number"},"443"),e(" and not "),n("span",{class:"token function"},"host"),e(),n("span",{class:"token number"},"17.248"),e(`
`)])]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br")])],-1),Y=n("p",null,"We got",-1),W=n("div",{class:"language-text ext-text line-numbers-mode"},[n("pre",{class:"language-text"},[n("code",null,`IP 172.20.18.78.64328 > tsa03s06-in-f22.1e100.net.https: tcp 123
IP tsa03s06-in-f22.1e100.net.https > 172.20.18.78.64328: tcp 0
IP tsa03s06-in-f22.1e100.net.https > 172.20.18.78.64328: tcp 113
IP tsa03s06-in-f22.1e100.net.https > 172.20.18.78.64328: tcp 1418
IP 172.20.18.78.64328 > tsa03s06-in-f22.1e100.net.https: tcp 0
IP tsa03s06-in-f22.1e100.net.https > 172.20.18.78.64328: tcp 1418
IP tsa03s06-in-f22.1e100.net.https > 172.20.18.78.64328: tcp 1418
IP tsa03s06-in-f22.1e100.net.https > 172.20.18.78.64328: tcp 1418
IP tsa03s06-in-f22.1e100.net.https > 172.20.18.78.64328: tcp 1418
IP tsa03s06-in-f22.1e100.net.https > 172.20.18.78.64328: tcp 1418
`)]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br"),n("span",{class:"line-number"},"4"),n("br"),n("span",{class:"line-number"},"5"),n("br"),n("span",{class:"line-number"},"6"),n("br"),n("span",{class:"line-number"},"7"),n("br"),n("span",{class:"line-number"},"8"),n("br"),n("span",{class:"line-number"},"9"),n("br"),n("span",{class:"line-number"},"10"),n("br")])],-1),F=n("blockquote",null,[n("p",null,"Timestamps are truncated")],-1),q=n("p",null,[e("There're many packets with size of "),n("strong",null,"1418"),e(", I can somehow assure that they are "),n("strong",null,"DATA"),e(" segments. Two of them have size of "),n("strong",null,"0"),e(", judging from above where we only capture SYN, I think then're SYN packets. Finally, two of them are in between the SYNs but have size of around "),n("strong",null,"120"),e(", I think they are "),n("strong",null,"ACK"),e(" packets without data payload.")],-1),B=n("blockquote",null,[n("p",null,[e("If you look up the address "),n("code",null,"tsa03s06-in-f22.1e100.net"),e(", you'll find it's also of Google's")])],-1),z=n("h2",{id:"ssh",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ssh","aria-hidden":"true"},"#"),e(" SSH")],-1),E=n("p",null,[e("Next up, let's login to "),n("strong",null,"ptt.cc"),e(" via ssh. It's TCP also.")],-1),H=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token function"},"ssh"),e(` bbsu@ptt.cc
`)])]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br")])],-1),K=n("p",null,"Since ssh uses port 22. We would listen for packets through port 22. This time, we catch all types of packets.",-1),j=n("div",{class:"language-text ext-text line-numbers-mode"},[n("pre",{class:"language-text"},[n("code",null,`tcpdump -ien0 -q -c10 port 22 
`)]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br")])],-1),L=n("p",null,"Because this port isn't as busy as HTTPS, we got a much cleaner output",-1),O=n("div",{class:"language-text ext-text line-numbers-mode"},[n("pre",{class:"language-text"},[n("code",null,`IP 172.20.18.78.64512 > 140.112.172.1.ssh: tcp 0
IP 140.112.172.1.ssh > 172.20.18.78.64512: tcp 0
IP 172.20.18.78.64512 > 140.112.172.1.ssh: tcp 0
IP 172.20.18.78.64512 > 140.112.172.1.ssh: tcp 21
IP 140.112.172.1.ssh > 172.20.18.78.64512: tcp 0
IP 140.112.172.1.ssh > 172.20.18.78.64512: tcp 40
IP 172.20.18.78.64512 > 140.112.172.1.ssh: tcp 0
IP 172.20.18.78.64512 > 140.112.172.1.ssh: tcp 1392
IP 140.112.172.1.ssh > 172.20.18.78.64512: tcp 1072
IP 172.20.18.78.64512 > 140.112.172.1.ssh: tcp 0
`)]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br"),n("span",{class:"line-number"},"4"),n("br"),n("span",{class:"line-number"},"5"),n("br"),n("span",{class:"line-number"},"6"),n("br"),n("span",{class:"line-number"},"7"),n("br"),n("span",{class:"line-number"},"8"),n("br"),n("span",{class:"line-number"},"9"),n("br"),n("span",{class:"line-number"},"10"),n("br")])],-1),G=n("blockquote",null,[n("p",null,"Timestamps are truncated")],-1),V=n("p",null,[n("code",null,"140.112"),e(", It's NTU of course! With the experiment above, we can now analyze these packets more easily. First, our computer sends a "),n("strong",null,"SYN"),e(" and the server from NTU sends a ACK of SYN. Oh no, it seems that our inference above was wrong. Based on what we've learned in class, the first three packets are usually for three-way handshaking, thus both SYN and ACK with no data are of size "),n("strong",null,"0"),e(".")],-1),R=n("h2",{id:"udp",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#udp","aria-hidden":"true"},"#"),e(" UDP")],-1),M=n("p",null,"With most of the applications using TCP, I wonder how can I find a application using UDP. Well, let's just directly listen on packets using UDP.",-1),J=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,`tcpdump -ien0 -q -c10 udp
`)]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br")])],-1),Q=n("p",null,"Got",-1),X=n("div",{class:"language-text ext-text line-numbers-mode"},[n("pre",{class:"language-text"},[n("code",null,`IP 172.20.18.78.57834 > dns.nsysu.edu.tw.domain: UDP, length 32
IP 172.20.18.78.54530 > dns.nsysu.edu.tw.domain: UDP, length 32
IP 172.20.18.78.61543 > dns.nsysu.edu.tw.domain: UDP, length 43
IP dns.nsysu.edu.tw.domain > 172.20.18.78.57834: UDP, length 82
IP dns.nsysu.edu.tw.domain > 172.20.18.78.54530: UDP, length 296
IP dns.nsysu.edu.tw.domain > 172.20.18.78.61543: UDP, length 166
IP 172.20.18.78.53708 > 239.255.255.250.ssdp: UDP, length 174
IP 172.20.18.78.33063 > 239.255.255.250.ssdp: UDP, length 174
IP 172.20.18.78.53555 > dns.nsysu.edu.tw.domain: UDP, length 46
IP dns.nsysu.edu.tw.domain > 172.20.18.78.53555: UDP, length 103
`)]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br"),n("span",{class:"line-number"},"4"),n("br"),n("span",{class:"line-number"},"5"),n("br"),n("span",{class:"line-number"},"6"),n("br"),n("span",{class:"line-number"},"7"),n("br"),n("span",{class:"line-number"},"8"),n("br"),n("span",{class:"line-number"},"9"),n("br"),n("span",{class:"line-number"},"10"),n("br")])],-1),Z=n("blockquote",null,[n("p",null,"Timestamps are truncated")],-1),$=n("p",null,[e("Turn out, "),n("strong",null,"DNS"),e(" uses UDP, and it constently synchrnized with my computer. We know that DNS has a hierarchy and since I'm under the Wi-Fi of NSYSU, the closest DNS server is located in the campus network. I also noticed that UDP typically uses ports with higher value around 50000-60000.")],-1),nn=n("p",null,[e("The other interesting thing is the "),n("strong",null,"ssdp"),e(" suffix. It seems to be a protocol under "),n("strong",null,"UPnP"),e(". And it's "),n("strong",null,"dangerous"),e(" according to many forum. Is there anything I need to worry?")],-1),en=n("h2",{id:"screen-shot",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#screen-shot","aria-hidden":"true"},"#"),e(" Screen Shot")],-1),sn=n("p",null,[n("img",{src:o,alt:"screenshot"})],-1);function tn(an,ln){return t(),s(a,null,[i,c,u,d,h,p,b,m,g,_,f,P,w,y,I,v,x,k,T,S,D,N,U,A,C,Y,W,F,q,B,z,E,H,K,j,L,O,G,V,R,M,J,Q,X,Z,$,nn,en,sn],64)}var cn=l(r,[["render",tn]]);export{cn as default};
